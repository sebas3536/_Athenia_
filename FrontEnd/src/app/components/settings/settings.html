<div class="container">
  <div>
    <h1 id="document-title" class="text-[#070025] mb-2 text-2xl font-bold">Configuración</h1>
    <p class="text-gray-600 mb-6">Personaliza tu experiencia y preferencias</p>
  </div>

  <!-- Perfil de Usuario -->
  <section class="p-6 border border-gray-200 rounded-xl mb-6">
    <div class="flex items-center gap-3 mb-6">
      <lucide-angular name="user" class="w-6 h-6 text-[#02ab74]"></lucide-angular>
      <h2 class="text-[#070025]">Perfil de Usuario</h2>
    </div>

    <div class="space-y-4">

      <app-profile-avatar [size]="5" [showEditControls]="true"></app-profile-avatar>
      <form [formGroup]="profileForm" (ngSubmit)="saveProfile()">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div class="space-y-2">
            <label for="name" class="block text-sm font-medium text-gray-700">Nombre Completo</label>
            <input type="text" id="name" formControlName="name"
              class="w-full pr-10 border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-[#02ab74]"
              placeholder="Ingresa tu nombre completo" [ngClass]="{'border-red-500': hasError('name')}">
            <p *ngIf="hasError('name')" class="text-red-500 text-sm">{{ getErrorMessage('name') }}</p>
          </div>
          <div class="space-y-2">
            <label for="email" class="block text-sm font-medium text-gray-700">Correo Electrónico</label>
            <input type="email" id="email" formControlName="email"
              class="w-full pr-10 border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-[#02ab74]"
              placeholder="Ingresa tu correo electrónico" [ngClass]="{'border-red-500': hasError('email')}">
            <p *ngIf="hasError('email')" class="text-red-500 text-sm">{{ getErrorMessage('email') }}</p>
          </div>
        </div>
      </form>
    </div>
  </section>

  <section class="border border-gray-200 rounded-xl overflow-hidden mb-6">
    <div class="p-6 border-b border-gray-200 bg-gray-50">
      <div class="flex items-center space-x-3">
        <div class="p-2 bg-[#933250] rounded-lg">
          <lucide-angular name="Smartphone" class="w-5 h-5 text-white"></lucide-angular>
        </div>
        <h2 class="text-[#070025] font-semibold">Convocatorias</h2>
      </div>
    </div>
    <div class="p-6">
      <div class="flex items-start justify-between mb-4">
        <div class="flex-1 pr-4">
          <h3 class="text-[#070025] mb-2 font-medium">Convocatorias de Minciencias</h3>
          <p class="text-gray-600 text-sm">
            Participa en los llamados públicos para financiar proyectos de ciencia, tecnología e innovación.
          </p>
        </div>
        <div class="relative inline-flex items-center cursor-pointer">
          <z-switch [(ngModel)]="convocatoriaEnabled" (ngModelChange)="onConvocatoriaToggle($event)"></z-switch>
        </div>
      </div>
    </div>
  </section>

  <!-- Notificaciones -->
  <section class="p-6 border border-gray-200 rounded-xl mb-6">
    <div class="flex items-center gap-3 mb-6">
      <lucide-angular name="bell" class="w-6 h-6 text-[#02ab74]"></lucide-angular>
      <h2 class="text-[#070025]">Notificaciones</h2>
    </div>

    <div class="space-y-4">
      <div class="flex items-center justify-between py-3 border-b border-gray-200">
        <div>
          <p class="text-[#070025]">Notificaciones por Email</p>
          <p class="text-sm text-gray-600">Recibe actualizaciones importantes por correo</p>
        </div>
        <z-switch [ngModel]="emailNotifications"
          (checkChange)="emailNotifications = $event; updateNotificationPreferences()" />
      </div>
      <div class="flex items-center justify-between py-3 border-b border-gray-200">
        <div>
          <p class="text-[#070025]">Notificaciones Push</p>
          <p class="text-sm text-gray-600">Recibe notificaciones en tiempo real</p>
        </div>
        <z-switch [ngModel]="pushNotifications"
          (checkChange)="pushNotifications = $event; updateNotificationPreferences()" />
      </div>
      <div class="flex items-center justify-between py-3">
        <div>
          <p class="text-[#070025]">Resumen Semanal</p>
          <p class="text-sm text-gray-600">Recibe un resumen de actividad cada semana</p>
        </div>
        <z-switch [ngModel]="weeklySummary" (checkChange)="weeklySummary = $event; updateNotificationPreferences()" />
      </div>
      <div class="flex justify-end">
        <button (click)="sendTestEmail()" class="border border-gray-500 p-2 rounded hover:bg-gray-100">
          Enviar Email de Prueba
        </button>
      </div>
    </div>
  </section>

  <!-- Preferencias -->
  <section class="p-6 border border-gray-200 rounded-xl mb-6">
    <div class="flex items-center gap-3 mb-6">
      <lucide-angular name="palette" class="w-6 h-6 text-[#02ab74]"></lucide-angular>
      <h2 class="text-[#070025]">Preferencias</h2>
    </div>
    <div class="space-y-4">
      <div class="space-y-2">
        <label for="language" class="flex items-center gap-2">
          <lucide-angular name="globe" class="w-4 h-4" />
          Idioma
        </label>
        <select id="language" [(ngModel)]="selectedLanguage" (change)="changeLanguage(selectedLanguage)"
          class="w-full px-4 py-2 border border-gray-200 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-[#02ab74]">
          <option *ngFor="let lang of languages" [value]="lang.code">{{ lang.flag }} {{ lang.label }}</option>
        </select>
      </div>
      <div class="space-y-2">
        <label for="theme" class="flex items-center gap-2">
          <lucide-angular [name]="selectedThemeIcon" class="w-4 h-4" />
          Tema de Interfaz
        </label>
        <select id="theme" [(ngModel)]="selectedTheme" (change)="changeTheme(selectedTheme)"
          class="w-full px-4 py-2 border border-gray-200 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-[#02ab74]">
          <option *ngFor="let theme of themes" [value]="theme.code">{{ theme.label }}</option>
        </select>
      </div>
    </div>
  </section>

  <!-- Guardar Cambios -->
  <div class="flex justify-end mb-6">
    <button (click)="saveProfile()" [disabled]="saving || profileForm.invalid"
      class="bg-[#02ab74] hover:bg-[#028a5f] text-white rounded-lg px-8 flex items-center h-10"
      aria-label="Guardar Cambios">
      <lucide-angular name="save" class="w-5 h-5 mr-2" />
      {{ saving ? 'Guardando...' : 'Guardar Cambios' }}
    </button>
  </div>
</div>